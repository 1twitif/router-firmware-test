<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



	<title>Gargoyle Router Management Utility</title>
	
	
	<script language="javascript" type="text/javascript" src="common.js"></script>
	<script language="javascript" type="text/javascript" src="port_forwarding.js"></script>
	<script language="javascript" type="text/javascript" src="table.js"></script>

<link rel="stylesheet" type="text/css" href="port_forwarding.css" media="all">
</head><body>
	<div id="darken"><iframe src="port_forwarding_1.html" id="d_iframe" class="select_free"></iframe></div>
	<div id="wait_msg">
		<div id="wait_txt">
			Please Wait While Settings Are Applied
		</div>
		<div id="wait_icon">
			<img src="wait_icon.gif">
		</div>
		<iframe src="port_forwarding_2.html" id="m_iframe" class="select_free"></iframe>
	</div>
	<div id="outer_logo">
		<div id="inner_logo">
			<div id="garg_title">Gargoyle</div>
			<div id="garg_desc">Router<br>Management<br>Utility</div>
			<div id="garg_host">Device Name: Gargoyle</div>
		</div>
	</div>
	<div id="outer_header"></div>
	<div id="outer_container">
		<div id="main_external_container">
			<div id="main_top"></div>
			<div id="main_internal_container">


<script>
<!--
	var gargoyleBinRoot = "/www/.";
	var wirelessIf = "wlan0";
	var uciWireless = "radio0";
	var currentWirelessMac = "30:46:9A:0B:88:35";
	var defaultLanIf = "eth0";
	var currentLanIf = "br-lan";
	var currentLanMac = "30:46:9A:0B:88:35";
	var currentLanIp = "192.168.1.1";
	var currentLanMask = "255.255.255.0";
	var defaultWanIf = "eth1";
	var defaultWanMac = "30:46:9A:0B:88:36";
	var currentWanIf = "eth1";
	var currentWanMac = "30:46:9A:0B:88:36";
	var currentWanIp = "192.168.0.8";
	var currentWanMask = "255.255.255.0";
	var currentWanGateway = "192.168.0.1";
	var uciOriginal = new UCIContainer();
	uciOriginal.set('firewall', 'cfg02f50e', '', "defaults");
	uciOriginal.set('firewall', 'cfg02f50e', 'syn_flood', "1");
	uciOriginal.set('firewall', 'cfg02f50e', 'input', "ACCEPT");
	uciOriginal.set('firewall', 'cfg02f50e', 'output', "ACCEPT");
	uciOriginal.set('firewall', 'cfg02f50e', 'forward', "REJECT");
	uciOriginal.set('firewall', 'cfg04e8f0', '', "zone");
	uciOriginal.set('firewall', 'cfg04e8f0', 'name', "lan");
	uciOriginal.set('firewall', 'cfg04e8f0', 'input', "ACCEPT");
	uciOriginal.set('firewall', 'cfg04e8f0', 'output', "ACCEPT");
	uciOriginal.set('firewall', 'cfg04e8f0', 'forward', "REJECT");
	uciOriginal.set('firewall', 'cfg062fd8', '', "zone");
	uciOriginal.set('firewall', 'cfg062fd8', 'name', "wan");
	uciOriginal.set('firewall', 'cfg062fd8', 'input', "REJECT");
	uciOriginal.set('firewall', 'cfg062fd8', 'output', "ACCEPT");
	uciOriginal.set('firewall', 'cfg062fd8', 'forward', "REJECT");
	uciOriginal.set('firewall', 'cfg062fd8', 'masq', "1");
	uciOriginal.set('firewall', 'cfg062fd8', 'mtu_fix', "1");
	uciOriginal.set('firewall', 'cfg087a91', '', "forwarding");
	uciOriginal.set('firewall', 'cfg087a91', 'src', "lan");
	uciOriginal.set('firewall', 'cfg087a91', 'dest', "wan");
	uciOriginal.set('firewall', 'cfg0a0261', '', "rule");
	uciOriginal.set('firewall', 'cfg0a0261', 'src', "wan");
	uciOriginal.set('firewall', 'cfg0a0261', 'proto', "udp");
	uciOriginal.set('firewall', 'cfg0a0261', 'dest_port', "68");
	uciOriginal.set('firewall', 'cfg0a0261', 'target', "ACCEPT");
	uciOriginal.set('firewall', 'cfg0c0a5e', '', "rule");
	uciOriginal.set('firewall', 'cfg0c0a5e', 'src', "wan");
	uciOriginal.set('firewall', 'cfg0c0a5e', 'proto', "icmp");
	uciOriginal.set('firewall', 'cfg0c0a5e', 'icmp_type', "echo-request");
	uciOriginal.set('firewall', 'cfg0c0a5e', 'target', "ACCEPT");
	uciOriginal.set('firewall', 'cfg0e2df3', '', "include");
	uciOriginal.set('firewall', 'cfg0e2df3', 'path', "/etc/firewall.user");
	uciOriginal.set('firewall', 'cfg10536b', '', "include");
	uciOriginal.set('firewall', 'cfg10536b', 'path', "/usr/lib/gargoyle_firewall_util/gargoyle_additions.firewall");
	uciOriginal.set('network', 'loopback', '', "interface");
	uciOriginal.set('network', 'loopback', 'ifname', "lo");
	uciOriginal.set('network', 'loopback', 'proto', "static");
	uciOriginal.set('network', 'loopback', 'ipaddr', "127.0.0.1");
	uciOriginal.set('network', 'loopback', 'netmask', "255.0.0.0");
	uciOriginal.set('network', 'lan', '', "interface");
	uciOriginal.set('network', 'lan', 'ifname', "eth0");
	uciOriginal.set('network', 'lan', 'type', "bridge");
	uciOriginal.set('network', 'lan', 'proto', "static");
	uciOriginal.set('network', 'lan', 'ipaddr', "192.168.1.1");
	uciOriginal.set('network', 'lan', 'netmask', "255.255.255.0");
	uciOriginal.set('network', 'wan', '', "interface");
	uciOriginal.set('network', 'wan', 'ifname', "eth1");
	uciOriginal.set('network', 'wan', 'proto', "dhcp");
	uciOriginal.set('network', 'cfg05cf9e', '', "switch");
	uciOriginal.set('network', 'cfg05cf9e', 'name', "rtl8366s");
	uciOriginal.set('network', 'cfg05cf9e', 'reset', "1");
	uciOriginal.set('network', 'cfg05cf9e', 'enable_vlan', "1");
	uciOriginal.set('network', 'cfg05cf9e', 'blinkrate', "2");
	uciOriginal.set('network', 'cfg076768', '', "switch_vlan");
	uciOriginal.set('network', 'cfg076768', 'device', "rtl8366s");
	uciOriginal.set('network', 'cfg076768', 'vlan', "1");
	uciOriginal.set('network', 'cfg076768', 'ports', "0 1 2 3 5");
	uciOriginal.set('network', 'cfg092a6b', '', "switch_port");
	uciOriginal.set('network', 'cfg092a6b', 'device', "rtl8366s");
	uciOriginal.set('network', 'cfg092a6b', 'port', "1");
	uciOriginal.set('network', 'cfg092a6b', 'led', "9");
	uciOriginal.set('network', 'cfg0b42e9', '', "switch_port");
	uciOriginal.set('network', 'cfg0b42e9', 'device', "rtl8366s");
	uciOriginal.set('network', 'cfg0b42e9', 'port', "2");
	uciOriginal.set('network', 'cfg0b42e9', 'led', "6");
	uciOriginal.set('network', 'cfg0d8c6c', '', "switch_port");
	uciOriginal.set('network', 'cfg0d8c6c', 'device', "rtl8366s");
	uciOriginal.set('network', 'cfg0d8c6c', 'port', "5");
	uciOriginal.set('network', 'cfg0d8c6c', 'led', "6");
	uciOriginal.set('dropbear', 'cfg02541f', '', "dropbear");
	uciOriginal.set('dropbear', 'cfg02541f', 'PasswordAuth', "on");
	uciOriginal.set('dropbear', 'cfg02541f', 'Port', "22");
	uciOriginal.set('upnpd', 'config', '', "upnpd");
	uciOriginal.set('upnpd', 'config', 'enabled', "0");
	uciOriginal.set('upnpd', 'config', 'secure_mode', "1");
	uciOriginal.set('upnpd', 'config', 'log_output', "0");
	uciOriginal.set('upnpd', 'config', 'download', "1024");
	uciOriginal.set('upnpd', 'config', 'upload', "512");
	uciOriginal.set('upnpd', 'config', 'external_iface', "wan");
	uciOriginal.set('upnpd', 'config', 'internal_iface', "lan");

	setBrowserTimeCookie();

	var testAjax = getRequestObj();
	if(!testAjax) { window.location = "no_ajax.sh"; }
//-->
</script>




<script>
<!--
var upnpdEnabled = false;

//-->
</script>


<form action="http://192.168.1.1/port_forwarding.sh">
	<fieldset>
		<legend class="sectionheader">Individual Port Forwarding</legend>

		<div id="portf_add_heading_container">
			<label class="nocolumn" id="portf_add_heading_label">Forward Individual Ports From WAN to LAN:</label>
		</div>
		<div class="bottom_gap">
			<div id="portf_add_container">
								<table>
					<tbody><tr class="table_row_add_header">
						<th><label id="add_app_label" for="add_host">Application Name</label><br><em>(optional)</em></th>
						<th><label id="add_prot_label" for="add_prot">Protocol</label></th>
						<th><label id="add_fp_label" for="add_fp">From Port</label></th>
						<th><label id="add_ip_label" for="add_ip">To IP</label></th>
						<th><label id="add_dp_label" for="add_dp">To Port<br><em>(optional)</em></label></th>
						<th></th>
					</tr>
					<tr class="table_row_add">
						<td><input value="" id="add_app" size="10" maxlength="10" type="text"></td>
						<td><select id="add_prot"><option value="Both">Both</option><option value="TCP">TCP</option><option value="UDP">UDP</option></select></td>
						<td><input value="" id="add_fp" size="5" onkeyup="proofreadNumericRange(this,1,65535)" maxlength="5" type="text"></td>
						<td><input value="" id="add_ip" size="20" onkeyup="proofreadIp(this)" maxlength="15" type="text"></td>
						<td><input value="" id="add_dp" size="5" onkeyup="proofreadNumeric(this,1,65535)" maxlength="5" type="text"></td>
							
						<td><input id="add_button" value="Add" class="default_button" onclick="addPortfRule()" type="button"></td>
					</tr>
				</tbody></table>
				
			</div>
		</div>
		
		<div id="portf_table_container" class="bottom_gap"><table style="display: none;" id="portf_table"><tbody><tr class="header_row"><th>Application</th><th>Protocol</th><th>From Port</th><th>To IP</th><th>To Port</th><th>Enabled</th><th></th><th></th></tr></tbody></table></div>	
	</fieldset>


	<fieldset>
		<legend class="sectionheader">Port Range Forwarding</legend>
		
		<div id="portfrange_add_heading_container">
			<label class="nocolumn" id="portf_add_heading_label">Forward Port Range From WAN to LAN:</label>
		</div>
		
		<div class="bottom_gap">
			<div id="portfrange_add_container">
								<table>
					<tbody><tr class="table_row_add_header">
						<th><label id="addr_app_label" for="addr_host">Application Name</label><br><em>(optional)</em></th>
						<th><label id="addr_prot_label" for="addr_prot">Protocol</label></th>
						<th><label id="addr_sp_label" for="addr_sp">Start Port</label></th>
						<th><label id="addr_ep_label" for="addr_ep">End Port</label></th>
						<th><label id="addr_ip_label" for="addr_ip">To IP</label></th>
						<th></th>
					</tr>
					<tr class="table_row_add">
						<td><input value="" id="addr_app" size="10" maxlength="10" type="text"></td>
						<td><select id="addr_prot"><option value="Both">Both</option><option value="TCP">TCP</option><option value="UDP">UDP</option></select></td>
						<td><input value="" id="addr_sp" size="5" onkeyup="proofreadNumericRange(this,1,65535)" maxlength="5" type="text"></td>
						<td><input value="" id="addr_ep" size="5" onkeyup="proofreadNumericRange(this,1,65535)" maxlength="5" type="text"></td>
						<td><input value="" id="addr_ip" size="20" onkeyup="proofreadIp(this)" maxlength="15" type="text"></td>
							
						<td><input id="addr_button" value="Add" class="default_button" onclick="addPortfRangeRule()" type="button"></td>
					</tr>
				</tbody></table>
	
			</div>
		</div>
		
		<div id="portfrange_table_container" class="bottom_gap"><table style="display: none;" id="portf_range_table"><tbody><tr class="header_row"><th>Application</th><th>Protocol</th><th>Start Port</th><th>End Port</th><th>To IP</th><th>Enabled</th><th></th><th></th></tr></tbody></table></div>		
	</fieldset>

	<fieldset>
		<legend class="sectionheader">DMZ</legend>
		<div id="dmz_enabled_container">
			<input id="dmz_enabled" onclick="setDmzEnabled()" type="checkbox">
			<label id="dmz_enabled_label" for="dmz_enabled">Use DMZ (De-Militarized Zone)</label>
		</div>
		<div id="dmz_ip_container" class="indent">
			<label class="leftcolumn" for="dmz_ip" id="dmz_ip_label">DMZ IP:</label>
			<input value="192.168.1.2" style="color: rgb(170, 170, 170);" disabled="disabled" class="text_disabled" name="dmz_ip" id="dmz_ip" onkeyup="proofreadIp(this)" size="20" maxlength="15" type="text">
		</div>
	</fieldset>

	
	<fieldset>
		<legend class="sectionheader">UPnP</legend>
		<div id="upnp_enabled_container">
			<input id="upnp_enabled" onclick="setUpnpEnabled()" type="checkbox">
			<label id="upnp_enabled_label" for="upnp_enabled">UPnP Enabled</label>
		</div>
		<div class="indent">
			<em>WARNING: The use of UPnP makes your system vulnerable to certain forms of attack, and is therefore
			a security risk.  However, UPnP is (unfortunately) necessary for some Microsoft applications including MSN messenger and
			the risk is relatively small.  Nevertheless, because of this security issue, UPnP is disabled by default.
			It is recommended that you enable UPnP only if you are sure you need it.</em>
		</div>


		<div id="upnp_up_container">
			<label class="leftcolumn" for="upnp_up" id="upnp_up_label">Max Up Speed on UPnP Ports:</label>
			<span class="rightcolumn">
				<input value="512" style="color: rgb(170, 170, 170);" disabled="disabled" class="text_disabled" id="upnp_up" onkeyup="proofreadNumeric(this)" size="5" maxlength="5" type="text">
				<em>Kbit / second</em>
			</span>
		</div>

		<div id="upnp_down_container">
			<label class="leftcolumn" for="upnp_down" id="upnp_down_label">Max Down Speed on UPnP Ports:</label>
			<span class="rightcolumn">
				<input value="1024" class="text_disabled" style="color: rgb(170, 170, 170);" disabled="disabled" id="upnp_down" onkeyup="proofreadNumeric(this)" size="5" maxlength="5" type="text">
				<em>Kbit / second</em>
			</span>
		</div>
		
	</fieldset>
	
	
	<div id="bottom_button_container">
		<input value="Save Changes" id="save_button" class="bottom_button" onclick="saveChanges()" type="button">
		<input value="Reset" id="reset_button" class="bottom_button" onclick="resetData()" type="button">
	</div>
	<span id="update_container">Please wait while new settings are applied. . .</span>

</form>


<!-- <br /><textarea style="margin-left:20px;" rows=30 cols=60 id='output'></textarea> -->

<script>
<!--
	resetData();
//-->
</script>


			</div>
			<div id="main_bottom"></div>
		</div>
		<div id="nav_external_container">
			<div id="nav_top"></div>
			<div id="nav_internal_container1">
				<div id="nav_internal_container2">
					<div class="nav_internal_end1"></div>
					<div class="nav_unselected_divider_end1"></div>
					<div class="nav_unselected_end1">
						<a indepth="true" href="index.html">Status</a>
					</div>
					<div class="nav_unselected_divider"></div>
					<div class="nav_unselected">
						<a indepth="true" href="basic.html">Connection</a>
					</div>
					<div class="nav_selected_divider1"></div>
					<div class="nav_selected">
						<div class="nav_selected_container">
							<div class="selected_header">Firewall</div>
							<div id="submenu_container">
								<div class="submenu_selected">Port Forwarding</div>
								<a indepth="true" href="connlimits.html">Connection Limits</a>
								<a indepth="true" href="restriction.html">Restrictions</a>
								<a indepth="true" href="quotas.html">Quotas</a>
								<a indepth="true" href="qos_upload.html">QoS (Upload)</a>
								<a indepth="true" href="qos_download.html">QoS (Download)</a>
							</div>
						</div>
					</div>
					<div class="nav_selected_divider2"></div>
					<div class="nav_unselected">
						<a indepth="true" href="access.html">System</a>
					</div>
					<div class="nav_unselected_divider"></div>
					<div class="nav_unselected">
						<a href="logout.html">Logout</a>
					</div>
					<div class="nav_unselected_divider_end2"></div>
					<div class="nav_internal_end2"></div>
				</div>
			</div>
			<div id="nav_bottom"></div>
		</div>
	</div>
	<div id="outer_footer"></div>
</body></html>
